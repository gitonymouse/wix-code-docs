{ "name": "ecom-payment-settings",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 1,
      "filename": "payment-settings-spi-index.js" },
  "docs":
    { "summary": "The eCommerce Payment Settings SPI.",
      "description":
        [ "The Payment Settings SPI allows you to apply custom payment settings during the payment process of an order. ",
          "For example, you can use the SPI to require an additional layer of security to certain orders.",
          "",
          "## Before you begin",
          "To collect payments, a Wix site must [connect a payment provider](https://support.wix.com/en/article/connecting-a-payment-provider). ",
          "Once a payment provider is connected you may use the Payment Settings SPI to enforce additional payment settings to your site's transactions. ",
          "For example, you may require additional [3d secure payments](https://support.wix.com/en/article/about-3d-secure-3ds-payments-with-third-party-payment-providers) (3DS)",
          "for certain payment methods. Note that each payment provider may have specific payment settings they accept with their Wix integration. ",
          "For example, [Tranzila](https://support.wix.com/en/article/connecting-tranzila-as-a-payment-provider) is a payment provider that ",
          "supports 3DS payments, but not all payment providers offer this feature. We recommend [contacting payment providers directly](https://support.wix.com/en/article/receiving-payouts-from-third-party-payment-providers) ",
          "to confirm which payment settings they have implemented as part of their Wix integration. Currently, the only payment setting available to customize ",
          "is whether to apply 3DS to an order.",
          "",
          "## Configuration",
          "Adding a custom extension to your site has 3 steps:",
          "1. [Add the extension to your site](https://dev.wix.com/docs/develop-websites/articles/coding-with-velo/integrations/custom-extensions-spis/custom-app-extensions-using-sp-is#step-1-create-a-new-extension-on-your-wix-site).",
          "2. Update the [`getConfig()`](https://www.wix.com/velo/reference/spis/ecom-payment-settings/getconfig) function in the **-config.js** file that is added to your site with step 1.",
          "3. Update the [`getPaymentSettings()`](https://www.wix.com/velo/reference/spis/ecom-payment-settings/getpaymentsettings) function in the **.js** file that is added to your site with step 1.",
          "",
          "## Resources",
          "+ See an example of implementing this SPI: [Tutorial: Payment Settings Custom Extension](https://support.wix.com/en/article/tutorial-payment-settings-custom-extension)",
          "+ Learn more about SPIs and Velo: [Velo: Custom App Extensions Using SPIs](https://support.wix.com/en/article/velo-custom-business-app-extensions-using-spis-beta)",
          "",
          "## Terminology",
          "",
          "| Term | Definition |",
          "| --- | --- |",
          "| 3 Domain Security (3DS) |An additional layer of security for online credit and debit card transactions. The name refers to the \"three domains\" which interact using the protocol: the card issuer, the acquiring bank, and the payment gateway that facilitates the transaction. Learn more [about 3DS payments with third-party payment providers](https://support.wix.com/en/article/about-3d-secure-3ds-payments-with-third-party-payment-providers). | ",
          "| Payment Providers |Different payment options available to your Wix site. Learn more about [accepting payments](https://support.wix.com/en/article/accepting-payments-an-overview). |" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "getConfig",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "fallbackValueForRequires3dSecure",
              "type": "boolean",
              "doc": "The value to set for `paymentSettings.requires3dSecure` if the SPI call fails.\n\nDefault: `false`" } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "ecom-payment-settings.PaymentSettingsConfigResponse" ] },
            "doc": "Fulfilled - The configuration settings." },
        "locations":
          [ { "lineno": 1,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "summary": "Use this function to set the custom default values for your \n[`getPaymentSettings()`](https://www.wix.com/velo/reference/spis/ecom-payment-settings/getpaymentsettings) function.",
            "description":
              [ "When you [add the Payment Settings custom extension](https://dev.wix.com/docs/develop-websites/articles/wix-apps/wix-e-commerce-stores/tutorial-payment-settings-custom-extension#step-1-create-a-new-payment-settings-extension), ",
                "it automatically adds a folder to your site. This file contains 2 files, **<your-extension-name>-config.js** and ",
                "**<your-extension-name>.js**.",
                "",
                "The first of these files, **<your-extension-name>-config.js**, is used to set any default configurations for your implementation of the custom extension.",
                "",
                "For the payment settings extension, the available default is to set a fallback value for whether to require ",
                "3DS to an order payment if the [`getPaymentSettings()`](https://www.wix.com/velo/reference/spis/ecom-payment-settings/getpaymentsettings) ",
                "function fails. ",
                "",
                "When `fallbackValueForRequires3dSecure` is set to `true`, then in a case where the SPI call fails it will, by default, ",
                "return `paymentSettings.requires3dSecure` set to `true` which tells the payment provider to require 3DS for the order.",
                "",
                "See [Tutorial: Payment Settings Custom Extension](https://support.wix.com/en/article/tutorial-payment-settings-custom-extension) ",
                "for a step-by-step tutorial." ],
            "links": [],
            "examples":
              [ { "title": "Example of an `spi-config.js` file",
                  "body":
                    [ "export function getConfig() {",
                      "  return {",
                      "    fallbackValueForRequires3dSecure: true",
                      "  };",
                      "};" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "customLabels":
              [ { "id": "maturity-beta" } ] } },
      { "name": "getPaymentSettings",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "options",
              "type": "ecom-payment-settings.Options",
              "doc": "The order information." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "ecom-payment-settings.PaymentSettingsResponse" ] },
            "doc": "Fulfilled - Retrieved payment settings." },
        "locations":
          [ { "lineno": 38,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "summary": "Retrieves the payment settings to apply to an order based on your custom logic. Wix passes on the settings to the payment provider.",
            "description":
              [ "When you [add the Payment Settings custom extension](https://dev.wix.com/docs/develop-websites/articles/wix-apps/wix-e-commerce-stores/tutorial-payment-settings-custom-extension#step-1-create-a-new-payment-settings-extension), ",
                "it automatically adds a folder to your site. This file contains 2 files, **<your-extension-name>-config.js** and ",
                "**<your-extension-name>.js**.",
                "",
                "The second of these files, **<your-extension-name>.js**, is used to write the code to determine which payment settings to apply to an order. ",
                "Currently, the only payment setting available to customize is whether to apply [3 domain security](https://support.wix.com/en/article/about-3d-secure-3ds-payments-with-third-party-payment-providers) (3DS) ",
                "to an order. If the code fails, then `requires3dSecure` will be set to the value for `fallbackValueForRequires3dSecure` set in ",
                "[`getConfig()`](https://www.wix.com/velo/reference/spis/ecom-payment-settings/getconfig).",
                "",
                "See [Tutorial: Payment Settings Custom Extension](https://support.wix.com/en/article/tutorial-payment-settings-custom-extension) ",
                "for a step-by-step tutorial." ],
            "links": [],
            "examples":
              [ { "title": "Example of a `paymentSettings` return value",
                  "body":
                    [ "export const getPaymentSettings = (options) => {",
                      "",
                      "  return {",
                      "    \"paymentSettings\": {",
                      "      \"requires3dSecure\": true",
                      "    }",
                      "  };",
                      "};" ],
                  "extra":
                    {  } },
                { "title": "Require 3DS if the order is greater than $50",
                  "body":
                    [ "export const getPaymentSettings = async (options) => {",
                      "  return {",
                      "    paymentSettings: {",
                      "      // Extract the subtotal price from the order, convert it to a number ",
                      "      // and check if the price is equal or greater than $50.",
                      "      requires3dSecure: parseFloat(options.order.priceSummary.subtotal.amount) >= 50",
                      "    }",
                      "  };",
                      "};",
                      "",
                      "/* If the subtotal price is less than 50, the following payment settings are returned:",
                      " *",
                      " * {",
                      " *   \"paymentSettings\": {",
                      " *     \"requires3dSecure\": \"false\"",
                      " *   }",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "customLabels":
              [ { "id": "maturity-beta" } ] } } ],
  "callbacks": [],
  "messages":
    [ { "name": "Options",
        "locations":
          [ { "lineno": 62,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "order",
              "type": "ecom-payment-settings.Order",
              "doc": "Order information." } ],
        "extra":
          {  },
        "labels":
          [ "changed" ] },
      { "name": "Order",
        "locations":
          [ { "lineno": 80,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "summary": "An object representing an order.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "_id",
              "type": "string",
              "doc": "Order ID.",
              "optional": true },
            { "name": "number",
              "type": "number",
              "doc": "Order number displayed in the site owner's dashboard (auto-generated).",
              "optional": true },
            { "name": "_createdDate",
              "type": "string",
              "doc": "Date and time the order was created in [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601#combined_date_and_time_representations) format.",
              "optional": true },
            { "name": "_updatedDate",
              "type": "string",
              "doc": "Date and time the order was updated in [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601#combined_date_and_time_representations) format.",
              "optional": true },
            { "name": "lineItems",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "payment-settings.OrderLineItem" ] },
              "doc": "Order line items.",
              "optional": true },
            { "name": "buyerInfo",
              "type": "payment-settings.BuyerInfo",
              "doc": "Buyer information.",
              "optional": true },
            { "name": "paymentStatus",
              "type": "string",
              "doc": "Order payment status.\n\nOne of:\n\n + `NOT_PAID`: This can be an order made online, but not yet paid. In such cases `order.status` will be `INITIALIZED`. This status also applies when an offline order needs to be manually marked as paid. In such cases `order.status` will be `APPROVED`.\n + `PAID`: All payments associated with this order are paid.\n + `PARTIALLY_REFUNDED`: Order was refunded, but refund amount is less than order total price.\n + `FULLY_REFUNDED`: Order fully refunded. Refund amount equals total price.\n + `PENDING`: Payments received but not yet confirmed by the payment provider.\n + `PARTIALLY_PAID`: At least one payment was received and approved, covering less than total price amount.",
              "optional": true },
            { "name": "fulfillmentStatus",
              "type": "string",
              "doc": "Order fulfillment status.\n\nOne of:\n\n + `NOT_FULFILLED`: Order is not yet fulfilled.\n + `FULFILLED`: Order was fulfilled successfully.\n + `PARTIALLY_FULFILLED`: Order was partially fulfilled. For example, when only some of the order's items were fulfilled.",
              "optional": true },
            { "name": "buyerLanguage",
              "type": "string",
              "doc": "Language for communication with the buyer. Defaults to the site language. For a site that supports multiple languages, this is the language the buyer selected.",
              "optional": true },
            { "name": "weightUnit",
              "type": "string",
              "doc": "Weight measurement unit - defaults to site's weight unit.\n\nOne of: `UNSPECIFIED_WEIGHT_UNIT`, `KG`, `LB`",
              "optional": true },
            { "name": "currency",
              "type": "string",
              "doc": "Currency used for the pricing of this order in [ISO-4217](https://en.wikipedia.org/wiki/ISO_4217#list_of_ISO_4217_currency_codes) format.",
              "optional": true },
            { "name": "taxIncludedInPrices",
              "type": "boolean",
              "doc": "Whether tax is included in line item prices.",
              "optional": true },
            { "name": "siteLanguage",
              "type": "string",
              "doc": "Site language in which original values are shown.",
              "optional": true },
            { "name": "priceSummary",
              "type": "payment-settings.PriceSummary",
              "doc": "Order price summary.",
              "optional": true },
            { "name": "billingInfo",
              "type": "payment-settings.BillingInfo",
              "doc": "Billing address and contact details.",
              "optional": true },
            { "name": "shippingInfo",
              "type": "payment-settings.OrderShippingInfo",
              "doc": "Shipping information.",
              "optional": true },
            { "name": "buyerNote",
              "type": "string",
              "doc": "[Buyer note](https://support.wix.com/en/article/wix-stores-viewing-buyer-notes) left by the customer.",
              "optional": true },
            { "name": "status",
              "type": "string",
              "doc": "Order status.\n\nOne of:\n\n + `INITIALIZED`: Order was created, but not yet approved or declined.\n + `APPROVED`: Order was approved. This happens when either the online payment succeeded or the order is an offline order. Once an order is approved, many side effects are triggered. For example, holding of stock in the inventory and sending of notification emails.\n + `CANCELED`: Order was canceled by the user.",
              "optional": true },
            { "name": "archived",
              "type": "boolean",
              "doc": "Whether order is archived.",
              "optional": true },
            { "name": "taxSummary",
              "type": "payment-settings.TaxSummary",
              "doc": "Tax summary.",
              "optional": true },
            { "name": "appliedDiscounts",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "payment-settings.AppliedDiscounts" ] },
              "doc": "Applied discounts.",
              "optional": true },
            { "name": "activities",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "payment-settings.Activities" ] },
              "doc": "Log of updates related to the order.",
              "optional": true },
            { "name": "attributionSource",
              "type": "string",
              "doc": "Order attribution source.\n\nOne of: `UNSPECIFIED`, `FACEBOOK_ADS`",
              "optional": true },
            { "name": "createdBy",
              "type": "payment-settings.CreatedBy",
              "doc": "ID of the order's initiator.",
              "optional": true },
            { "name": "channelInfo",
              "type": "payment-settings.ChannelInfo",
              "doc": "Information about the sales channel that submitted this order.",
              "optional": true },
            { "name": "seenByAHuman",
              "type": "boolean",
              "doc": "Whether a human has seen the order. Set when an order is clicked on in the Business Manager.",
              "optional": true },
            { "name": "checkoutId",
              "type": "string",
              "doc": "Checkout ID.",
              "optional": true },
            { "name": "customFields",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "payment-settings.CustomFields" ] },
              "doc": "Custom fields.",
              "optional": true },
            { "name": "additionalFees",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "payment-settings.AdditionalFees" ] },
              "doc": "Additional fees applied to the order.",
              "optional": true },
            { "name": "purchaseFlowId",
              "type": "string",
              "doc": "Persistent ID that correlates between the various eCommerce elements: cart, checkout, and order.",
              "optional": true } ],
        "extra":
          {  },
        "labels":
          [ "new" ] },
      { "name": "PaymentSettings",
        "locations":
          [ { "lineno": 74,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "requires3dSecure",
              "type": "boolean",
              "doc": "Whether to apply [3D Secure](https://support.wix.com/en/article/about-3d-secure-3ds-payments-with-third-party-payment-providers) during the payment process." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "PaymentSettingsConfigResponse",
        "locations":
          [ { "lineno": 31,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "fallbackValueForRequires3dSecure",
              "type": "boolean",
              "doc": "The value to set for `paymentSettings.requires3dSecure` if the SPI call fails.\n\nDefault: `false`" } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "PaymentSettingsResponse",
        "locations":
          [ { "lineno": 68,
              "filename": "payment-settings-spi.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "paymentSettings",
              "type": "ecom-payment-settings.PaymentSettings",
              "doc": "Retrieved payment settings." } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    {  } }